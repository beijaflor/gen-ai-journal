## The complete guide to MCP security: How to secure MCP servers & clients

https://workos.com/blog/mcp-security-risks-best-practices

本ガイドは、モデルコンテキストプロトコル（MCP）導入における主要なセキュリティリスクを詳述し、安全で信頼性の高いAI統合を構築するためのサーバーおよびクライアント向け実践的ベストプラクティスを提示する。

**Content Type**: Tutorial & Guide

**Scores**: Signal:4/5 | Depth:5/5 | Unique:4/5 | Practical:5/5 | Anti-Hype:5/5
**Main Journal**: 94/100 | **Annex Potential**: 92/100 | **Overall**: 92/100

**Topics**: [[Model Context Protocol (MCP), AIセキュリティ, プロンプトインジェクション, LLMエージェント, APIセキュリティ]]

MCP（Model Context Protocol）は、LLMが外部ツールやAPIと構造的に連携し、データ取得やワークフロー実行を可能にする、AIインフラの重要な進化です。しかし、この強力な機能は、信頼できないモデル生成入力と機密システムとの間に新たな橋をかけ、独自のセキュリティリスクをもたらします。本記事は、このリスクに対処するための包括的なガイドです。

主要な脅威として、プロンプトインジェクションやツールポイズニングによるモデル操作、入力サニタイズ不足によるコマンド実行・コードインジェクション、不適切なトークン管理によるトークン盗難や認証情報漏洩が挙げられます。さらに、過剰なパーミッション付与、未検証のサードパーティエンドポイントへの接続、悪意あるMCPサーバー、OAuthプロキシフローにおけるConfused Deputy攻撃、トークンパススルーのアンチパターン、そしてリプレイ攻撃やセッションハイジャックなど、多岐にわたる攻撃ベクトルが指摘されています。

これらのリスクに対し、記事ではサーバーとクライアントそれぞれに具体的なベストプラクティスを提示します。サーバー側では、OAuth 2.1と最小権限の原則に基づく厳格な認証・認可、パラメータ化クエリとサンドボックス化による入力サニタイズ、短寿命JWTと安全なトークン保管、きめ細やかなスコープ管理、署名付きレジストリによるエンドポイント検証、包括的なロギングと監視、そしてサプライチェーンセキュリティの確保が強調されています。クライアント側では、署名付きメタデータと信頼できるレジストリを用いた安全なサーバー発見と信頼確立、PKCE付きOAuth 2.1による厳格な認可フロー、mTLSを含む接続セキュリティの強化、ツール定義の検証、モデルリクエストの入力検証、トークンの安全な管理と分離、セッションの完全性維持とリプレイ防止、ユーザーへのツール利用の透明性確保、ローカル実行のサンドボックス化、そしてサンプリング制御が重要だと説いています。

なぜこれが重要か？ webアプリケーションエンジニアにとって、MCPはLLMを単なるテキスト生成器から、実際にタスクを実行する強力なエージェントへと変貌させる可能性を秘めています。この新しい連携レイヤーのセキュリティを疎かにすると、既存のシステムへの深刻な侵害やデータ漏洩に直結します。本ガイドは、先進的なAI統合の恩恵を享受しつつ、これらの新しい攻撃経路を確実に塞ぎ、堅牢なシステムを構築するための具体的な道筋を示しており、その実践は不可欠です。