## LLMs + Coding Agents = Security Nightmare

https://garymarcus.substack.com/p/llms-coding-agents-security-nightmare

AIを活用したコーディングエージェントが、プロンプトインジェクションや隠れた悪意あるコードを通じて甚大なセキュリティ脆弱性を生み出し、リモートコード実行のリスクを劇的に高めていると警鐘を鳴らす。

**Content Type**: 🎭 AI Hype

**Scores**: Signal:5/5 | Depth:4/5 | Unique:5/5 | Practical:5/5 | Anti-Hype:5/5
**Main Journal**: 97/100 | **Annex Potential**: 98/100 | **Overall**: 96/100

**Topics**: [[AI Security, コーディングエージェント, プロンプトインジェクション, サプライチェーン攻撃, リモートコード実行]]

AIを活用したコーディングエージェントは、開発者の生産性を劇的に向上させる一方で、サイバーセキュリティの新たな悪夢を引き起こしています。本記事は、Black HatカンファレンスでのNvidia研究者やKudelski SecurityのNathan Hamiel氏による発表に基づき、これらのツールがもたらす深刻な脅威を詳述しています。

問題の根源は、LLMの予測不可能性と、エージェントに与えられる広範な権限です。従来のプロンプトインジェクションに加え、攻撃者はGitHubリポジトリ内の白文字や空白に悪意ある命令を隠したり、ASCIIスムーグリング技術を用いてCursorなどのエージェントツールの「ルールファイル」に不可視のコードを埋め込んだりすることが可能です。特に、Cursorの「Auto-Runモード」（旧YOLOモード）のように、ユーザー確認なしにコマンド実行やファイル書き込みを許可する設定は、システム乗っ取りのリスクを劇的に高めます。

また、CodeRabbitのようなAI搭載型開発者生産性ツールが悪用された事例も示されており、これにより攻撃者が顧客のGitHub環境で昇格された権限を獲得し、数百万のリポジトリへの書き込みアクセスや、GitHubプライベートキー、AWS Adminキーといった機密情報を盗み出すことが可能になることが実証されました。これは、サプライチェーン攻撃を通じて広範囲な被害をもたらす潜在力があり、企業全体の運営が危うくなるレベルです。

開発者にとって、これらのエージェントの利便性は魅力的ですが、その裏にはシステムが完全に侵害されるリモートコード実行（RCE）の危険が常に潜んでいます。急いでいる時や経験の浅い「Vibeコーディング」では、人間が見逃すような巧妙な攻撃を許可してしまう可能性があります。

推奨される対策として、エージェントに与える自律性の制限（自動インストール禁止など）、厳重なガードレールの追加、ファイルアクセス権限の最小化が挙げられます。Nathan Hamiel氏は、高リスクシナリオでのLLM利用を「控える」（Refrain）、実行権限やアクセスレベルを「制限する」（Restrict）、システムへの入出力を「監視する」（Trap）という「RRT戦略」を提唱しています。究極的には、LLMコーディングエージェントを過信せず、「怠惰で酩酊したロボット」として扱うべきだという厳しい現実を突きつけています。生産性向上への誘惑は強いものの、開発者はセキュリティリスクを十分に認識し、慎重な利用が求められます。