## Cursorなどで使える「サブエージェント」を擬似実現するMCPサーバーを作った話

https://tacoms-inc.hatenablog.com/entry/2025/08/18/114225

本記事は、Cursor CLIやClaude Codeでサブエージェント機能を擬似的に実現するMCPサーバー「sub-agents-mcp」を開発し、その実装とAgentic Codingにおけるコンテキスト管理の重要性について解説します。

**Content Type**: ⚙️ Tools

**Scores**: Signal:4/5 | Depth:4/5 | Unique:4/5 | Practical:5/5 | Anti-Hype:5/5
**Main Journal**: 88/100 | **Annex Potential**: 87/100 | **Overall**: 88/100

**Topics**: [[AIコーディング, エージェント指向プログラミング, LLM, コンテキスト管理, MCP]]

ウェブアプリケーションエンジニアにとって、AIを活用したコーディング（Agentic Coding）におけるコンテキスト管理とタスク分解は極めて重要です。本記事では、この課題に対し、Cursor CLIやClaude Codeで「サブエージェント」機能を擬似的に実現するMCP（Model Context Protocol）サーバー「sub-agents-mcp」の開発が紹介されています。

このツールは、メインエージェントのコンテキストウィンドウ枯渇を防ぎ、不必要な情報を排除することでAIの応答精度を向上させる目的で作成されました。特に、Cursor CLIがネイティブでサブエージェントをサポートしていないという課題に対し、独自のMCPサーバーを構築するという具体的な解決策を提示しています。

実装では、Markdownファイルでサブエージェントの定義（システムコンテキスト）を行い、特定のタスクに特化させることで、AIが単一の責任を果たす単位で動作するよう促します。例えば、コード生成とレビューを別のサブエージェントに分離することで、それぞれのタスクに必要なコンテキストのみを与え、出力精度を高める手法は、効率的なAgentic Codingの設計原則として極めて参考になります。

また、本サーバーは`run_agent`ツールを提供し、人間が自然な指示でサブエージェントを呼び出せるように設計されています。このアプローチは、LLMによる調査・分析後に人間が計画を承認する仕組みや、型チェック・テストを自動実行する品質保証の段階的導入など、より堅牢なAI開発ワークフローを構築するヒントを与えます。

実用上の注意点として、複雑な処理におけるCursor CLIのタイムアウト問題にも言及しており、現実的な利用シーンを考慮した実践的な知見が共有されています。これは、AIツールの導入を検討するエンジニアにとって、実際の障壁と対処法を理解する上で非常に価値のある情報です。結論として、本ツールはAIを活用した開発におけるコンテキスト管理とタスク分解の重要性を再認識させ、より精度の高いエージェント駆動型開発を可能にする具体的なソリューションを提供します。