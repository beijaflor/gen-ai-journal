## チームのCLAUDE.mdが勝手に育つ - Hook機能での自動化

https://zenn.dev/appbrew/articles/e2f38677f6a0ce

Claude CodeのHook機能を活用し、チームの知見を蓄積するCLAUDE.mdへのルール提案をセッション終了時やコンテキスト圧縮時に自動実行する仕組みを構築し、運用課題を解決します。

**Content Type**: Tools
**Language**: ja

**Scores**: Signal:5/5 | Depth:5/5 | Unique:4/5 | Practical:5/5 | Anti-Hype:5/5
**Main Journal**: 96/100 | **Annex Potential**: 93/100 | **Overall**: 96/100

**Topics**: [[Claude Code, AIエージェント, 開発ワークフロー自動化, ナレッジ共有, Hook機能]]

この記事では、開発チームの知識ベースである`CLAUDE.md`の更新忘れや新規メンバーへの周知不足といった課題を解決するため、AIコーディングツール「Claude Code」のHook機能を活用した自動化メカニズムが紹介されています。著者は、以前の記事でスラッシュコマンドによる手動提案システムを構築したものの、その運用には限界があったと指摘。そこで、Claude Codeの「SessionEnd（セッション終了時）」と「PreCompact（コンテキスト圧縮前）」という特定のイベントをトリガーに、会話履歴を分析して`CLAUDE.md`に追記すべきルールを自動提案するシステムを開発しました。

このシステムは、Hook設定ファイル（`.claude/settings.json`）と会話履歴分析スクリプト（`bin/suggest-claude-md-hook.sh`）で構成されています。特に重要なのは、Hook内でClaudeを再実行する際の無限ループ対策、既存の会話コンテキストへの影響を避けるための別プロセスでの実行、そしてJSONL形式の会話履歴からテキストコンテンツを正確に抽出する処理です。スクリプトは、新しいターミナルウィンドウを起動して提案生成を行うため、ユーザーの現在の作業を妨げません。

著者は、この自動化により、プロジェクト独自のルール、繰り返される修正指示、関連箇所で統一すべきパターンといった暗黙知が自然と`CLAUDE.md`に蓄積され、チーム全体の知識共有が促進されると主張しています。運用開始から1ヶ月で問題なく機能しているものの、さらなる長期的な評価や他のチームメンバーからのフィードバックを求めている点も、実直な視点として示されています。これは、AIを活用した開発ワークフローの改善と、チームのオンボーディングコスト削減に直結する実践的なアプローチと言えるでしょう。