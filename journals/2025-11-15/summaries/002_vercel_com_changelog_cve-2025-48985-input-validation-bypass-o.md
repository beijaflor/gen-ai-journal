## CVE-2025-48985: AI SDKにおける入力検証バイパスの脆弱性

https://vercel.com/changelog/cve-2025-48985-input-validation-bypass-on-ai-sdk

**Original Title**: CVE-2025-48985: Input Validation Bypass on AI SDK

VercelのAI SDKに、ファイルアップロード時のファイルタイプホワイトリストをバイパスできる低重要度のセキュリティ脆弱性が見つかり、修正されました。

**Content Type**: News & Announcements
**Language**: en

**Scores**: Signal:5/5 | Depth:4/5 | Unique:3/5 | Practical:5/5 | Anti-Hype:5/5
**Main Journal**: 92/100 | **Annex Potential**: 87/100 | **Overall**: 88/100

**Topics**: [[AI SDK, Vercel, Security Vulnerability, Input Validation, File Upload Bypass, CVE]]

VercelのAI SDKにおいて、ファイルアップロード時の入力検証をバイパスする低重要度のセキュリティ脆弱性（CVE-2025-48985）が発見され、バージョン5.0.52および6.0.0-beta.*で修正されました。この脆弱性は、プロンプト変換パイプライン内の`convert-to-language-model-prompt.ts`ファイルに起因し、不適切なURLからデータへのマッピングにより、ダウンロードされたファイルの配列と本来のダウンロード計画の配列間でインデックスのずれが生じました。

その結果、攻撃者はサポートされていないURLからのバイトをサポートされているURLスロットに誤ってマッピングさせ、URLベースの信頼やコンテンツ検証メカニズムを迂回して任意のコンテンツを注入できる可能性がありました。特に、画像やファイルを引数として受け入れる`generateText()`および`streamText()`関数が、SDK外で明示的なデータ検証が実装されていない場合に影響を受けました。この問題は、ファイルのフィルタリング前にマッピングを行うことで解決されています。Vercelは、AI SDKを使用する開発者に対し、速やかに最新バージョンへアップグレードするか、SDK外でカスタムファイルタイプ検証ロジックを実装するよう推奨しています。