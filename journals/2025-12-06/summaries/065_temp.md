## LLMの安定した出力のために - Prompt Linterの活用

https://tech.newmo.me/entry/prompt-linter

newmoは、AI電話配車システムにおけるLLMの安定した構造化出力を実現するため、LLM自体にプロンプトの品質をレビューさせる「Prompt Linter」という独自の品質管理アプローチを開発し、その具体的な仕組みと重要性を解説しています。

**Content Type**: ⚙️ Tools
**Language**: ja

**Scores**: Signal:4/5 | Depth:4/5 | Unique:4/5 | Practical:5/5 | Anti-Hype:5/5
**Main Journal**: 88/100 | **Annex Potential**: 87/100 | **Overall**: 88/100

**Topics**: [[プロンプトエンジニアリング, LLM出力安定化, プロンプト品質保証, エージェントアーキテクチャ, CI/CD]]

newmoのAI電話配車システムでは、LLMの不確実性を限定的にするため、従来のプログラムがオーケストレーターとなり、LLMは構造化データを出力する役割を担うアーキテクチャを採用しています。しかし、この重要な構造化出力が、プロンプト内の曖昧さや矛盾が原因で不安定になる問題に直面しました。例えば、「会話継続」と「JSON出力」の分岐を一本化せず、会話継続時にもJSONにメッセージを閉じ込める形に変更する、あるいは「完全な住所がわかってからJSON出力」といった誤解を招く指示を排除するなどの試みから、プロンプトの品質がLLMの安定性に直結することが判明しました。

プロンプトは自然言語で記述されるため、プログラミング言語のようなコンパイラによる構文チェックがなく、論理的な矛盾や曖昧さが見過ごされがちです。特にプロンプトが長大化すると、人間によるレビューでは限界があります。

この課題に対し、newmoは「Prompt Linter」という画期的なアプローチを導入しました。これは、自然言語の理解に長けたLLMに、検証対象のプロンプトと「明確性」「一貫性」「避けるべきアンチパターン」などのチェックルールを与え、プロンプトの品質をレビューさせるというものです。ソースコードのLinterと同様に、プロンプトの保守性や拡張性といった観点もチェックルールに盛り込むことで、単なる動作の安定性だけでなく、将来的な変更にも耐えうる品質を確保することを目指しています。

このPrompt Linterの活用により、チームは機械的に論理矛盾や曖昧な表現を発見できるようになり、プロンプト品質の向上を実現しました。今後は、CI/CDパイプラインに組み込み、プルリクエスト時に自動でプロンプトの品質チェックが実行されるようにすることで、コードと同様の厳密な品質管理体制を確立する計画です。LLMを活用したシステムにおいて、プロンプトがコア資産となる中で、Prompt Linterのような品質保証の仕組みは、安定した運用と継続的な改善を可能にする重要なツールとして、その価値を大きく高めていくでしょう。