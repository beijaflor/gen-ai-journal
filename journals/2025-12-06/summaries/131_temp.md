## Claude Code スキル・サブエージェント攻略ガイド

https://zenn.dev/oligin/articles/7691926a83936a

Claude Codeのスキルやサブエージェントが期待通りに動作しない一般的な問題を解決し、確実な活用方法を解説する。

**Content Type**: ⚙️ Tools
**Language**: ja

**Scores**: Signal:4/5 | Depth:4/5 | Unique:5/5 | Practical:5/5 | Anti-Hype:5/5
**Main Journal**: 92/100 | **Annex Potential**: 93/100 | **Overall**: 92/100

**Topics**: [[Claude Code, AIエージェント, スキル, プロンプトエンジニアリング, 開発ツール]]

この記事は、Claude Codeのスキルとサブエージェントを確実に動作させるための実践的な攻略ガイドを提供しています。著者は、公式ドキュメントには記載されていない「罠」が存在し、それが開発者のフラストレーションの原因になっていると指摘します。

主要な発見として、まずスキルがデフォルトでは発動しない根本原因が「Skillツール」の権限拒否にあることを明らかにしています。通常、スキルはClaude Codeに認識されても、明示的に`--allowed-tools "Skill"`で許可するか、`.claude/settings.json`に`"permissions": {"allow": ["Skill(*)"]}`と記述しなければ使用がブロックされます。スキル内の`allowed-tools`は、そのスキルが使用できるツールを制限するものであり、スキル自体の使用許可を与えるものではありません。また、スキルは「常に自動適用される暗黙のコンテキスト」ではなく、適切にトリガーされない限り適用されないことが強調されています。

次に、サブエージェントの発動率に関する問題が検証されています。カスタムサブエージェントは、`description`に含まれるキーワードに厳密にマッチした場合のみ発動し、その発動率は約25%と低いことが判明しました。これに対し、組み込みエージェントが高い発動率を持つのは、システムプロンプトに起動条件がハードコードされているためだと説明しています。この問題を解決するため、著者は`CLAUDE.md`ファイルを作成し、ここにサブエージェントの起動条件を記述する方法を提案しています。`CLAUDE.md`はカスタムシステムプロンプトとして機能し、ここに明示的なトリガー条件を記述することで、サブエージェントの発動率を100%に向上させられることを実証しました。

この検証を通じて、最終的な推奨構成が提示されています。`CLAUDE.md`は常に適用される全体ルールやエージェント起動条件の記述に最適であり、サブエージェントと組み合わせて厳密なタスク実行に活用します。一方、スキルは条件付きで発動し、複数のサブエージェント間で共有される技術スタックやコーディング規約、ドメイン知識といった知識ベースとして利用するのが効果的です。特に、サブエージェントがスキル内の知識を参照できることが示されており、これにより共通知識を効率的に管理できる利点があります。

この記事は、Claude Codeをより深くカスタマイズし、プロジェクト固有の要件に合わせて効果的に活用したいウェブアプリケーションエンジニアにとって、公式ドキュメントでは得られない具体的な解決策と「なぜそれが重要なのか」という深い洞察を提供します。誤解されやすいスキルとエージェントの挙動を正しく理解することで、大幅な時間節約と開発効率の向上が期待できるでしょう。