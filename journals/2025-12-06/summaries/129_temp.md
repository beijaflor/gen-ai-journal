## Claude Codeのトークン消費を節約する

https://zenn.dev/shintaroamaike/articles/d53921404e4c09

Claude Codeのトークン消費を抑え、出力品質を向上させる具体的な設定と指示方法を解説する。

**Content Type**: ⚙️ Tools
**Language**: ja

**Scores**: Signal:4/5 | Depth:4/5 | Unique:4/5 | Practical:5/5 | Anti-Hype:4/5
**Main Journal**: 86/100 | **Annex Potential**: 84/100 | **Overall**: 84/100

**Topics**: [[Claude Code, トークン最適化, AIプロンプトエンジニアリング, 開発ワークフロー, 設定管理]]

このZenn記事は、AIコーディング支援ツール「Claude Code」をより効率的に利用し、トークン消費を節約するための実践的なノウハウを、ウェブアプリケーションエンジニアに向けて詳細に解説しています。著者は、月額のProプランでもすぐに上限に達してしまう課題に対し、不要な出力を削減し、結果として一日あたりの利用回数を増やすための具体的アプローチを提示しています。

まず、著者はAIへの「指示の工夫」が不可欠であると強調します。曖昧な指示はAIを混乱させ、冗長なコード生成や無駄なトークン消費につながるため、フロントエンドとバックエンドの技術スタック（例: React/TypeScript, FastAPI, Pydantic）を明確にし、リクエスト/レスポンスモデル定義、URL重複チェック、エラーハンドリングといった具体的な要件を指示することが重要です。また、「一度に大量の指示をしない」ことも効果的であり、タスクをフェーズ分けして一つずつ実装させることで、AIの処理能力の限界を考慮しつつ効率的な開発を促します。

さらに、AIがプロジェクト全体を不必要にスキャンするのを防ぐため、「確認するファイルを指定する」ことの重要性が挙げられています。特定のファイルや関数単位で指示を与えることで、修正範囲を限定できます。特にClaude 4.5 Sonnetで顕著になった出力の冗長化、具体的には「解説書を作成させない」ための制御方法が詳細に説明されています。これには、`.claude/settings.json` を使用して`docs/`ディレクトリや`README.md`への書き込みを物理的に`deny`する設定や、`hooks`機能を使ってドキュメント作成タスクを事前にブロックする方法が含まれます。

最も実践的なアドバイスの一つとして、著者は`.claude/instructions.md` ファイルを活用し、AIの出力原則を厳格に定義することを推奨しています。「コード直接出力、説明最小化」を徹底し、「ドキュメント作成」「README更新」「コメント追加（docstring以外）」といったタスクを明示的に禁止するルールを設定することで、AIが生成するコンテンツの品質とフォーマットを制御します。さらに、PEP8準拠、型ヒント、Googleスタイルdocstring、日本語コメントの必須化など、具体的なコーディング規約をAIに遵守させるための詳細なガイドラインも示されており、これらを適用することで、生成されるコードの保守性と一貫性を高めることができます。

著者は、Claude Codeが非常に強力なツールである一方で、まだ限界があることを理解し、その特性を把握した上で適切な指示と設定を行うことが、理想に近い挙動を引き出す鍵であると結論付けています。AIモデルのアップデートによって挙動が変化することも多いため、常に設定を見直し、調整していく柔軟な姿勢が重要であると述べています。