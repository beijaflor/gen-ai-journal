## お天気エージェントを作りながら学ぶCodex CLI SDK入門

https://tech-blog.rakus.co.jp/entry/20251201/codex-cli-sdk

OpenAIのCodex CLI SDKを活用し、効率的なプロンプトエンジニアリングによって安定した出力を提供するお天気エージェントをTypeScriptで構築する実践的な手順を解説します。

**Content Type**: Tutorial & Guide
**Language**: ja

**Scores**: Signal:4/5 | Depth:4/5 | Unique:3/5 | Practical:5/5 | Anti-Hype:4/5
**Main Journal**: 85/100 | **Annex Potential**: 79/100 | **Overall**: 80/100

**Topics**: [[Codex CLI SDK, AIエージェント開発, プロンプトエンジニアリング, TypeScript, 構造化出力]]

この記事は、OpenAIが提供するローカル実行型コーディングエージェント「Codex CLI」をTypeScript (JavaScript) から操作できる「Codex CLI SDK」の入門ガイドです。ChatGPTの有料プランユーザーは追加費用なしで利用できるため、手軽に自分だけのAIエージェントを構築したい開発者にとって、このSDKは非常に魅力的だと筆者は主張します。

記事ではまず、Codex CLIとSDKの概要を説明し、Node.js 24.11.1や関連するSDKパッケージの導入、Codex CLIの設定といった環境構築について解説します。SDKの基本的な操作として、`new Codex()`でオブジェクトを作成し、`codex.startThread()`でセッションを開始、`thread.run()`でメッセージを送信する一連の流れを具体的なコードとともに示します。特に、逐次的なレスポンスが必要な場合は`codex.runStreamed()`の使用が推奨される点も強調されています。

次に、お天気エージェントを題材にした実践的な開発フェーズに入ります。初期段階では単純な天気問い合わせで回答形式が不安定になる問題を提示し、これを解決するためにプロンプトエンジニアリングの重要性を説きます。システムプロンプトでお天気アシスタントとしての役割を定義し、出力形式を厳密に指定する`output_template`を組み合わせることで、回答の安定化を実現。この際、`output_template`をプロンプトの最後に配置することで、出力形式が安定しやすいという具体的なノウハウが共有されています。

さらに、エージェントが現在の日付を正確に認識しないという課題に対し、TypeScriptで日付情報を動的に生成し、これをユーザー入力の一部としてプロンプトに組み込むことで解決する手法を紹介。これにより、エージェントは常に正確な日付に基づいた天気予報を提供できるようになります。

筆者は、Codex CLI SDKがコストをかけずにAIエージェントを開発できる大きなメリットを持つことを改めて強調し、将来的なmcpや構造化出力の活用によるさらなる改良の可能性にも触れつつ、読者に対しAIエージェント開発への挑戦を促しています。これは、ウェブアプリケーションエンジニアがAIツールを開発ワークフローに統合し、より実践的な価値を生み出すための重要な指針となるでしょう。