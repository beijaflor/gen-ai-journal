## AIエージェント間の「ルールの差分」をrulesyncで一元管理して解決した話

https://tech.asoview.co.jp/entry/2025/12/06/100000

本記事は、`rulesync`が複数のAIエージェント間で発生するルール定義の差分を一元管理し、特にモノレポ環境における開発効率の課題を解決する手法を解説します。

**Content Type**: ⚙️ Tools
**Language**: ja

**Scores**: Signal:4/5 | Depth:4/5 | Unique:3/5 | Practical:5/5 | Anti-Hype:4/5
**Main Journal**: 81/100 | **Annex Potential**: 77/100 | **Overall**: 80/100

**Topics**: [[AIエージェント管理, rulesync, モノレポ, 開発ワークフロー, ルール自動生成]]

アソビューの技術ブログは、GitHub CopilotやCursor、Claudeといった複数のAIエージェントを開発に活用する際、各エージェント固有のルール定義ファイル形式が原因で発生する「ルール定義の差分」という課題について解説しています。この差分は、手動での更新作業においてミスや漏れを引き起こし、エージェント間で適用されるルールに不整合が生じる原因となっていました。

この問題を解決するために導入されたのが、AIエージェント用の設定ファイルを一元管理・同期するツール「rulesync」です。rulesyncは、一つのマスターMarkdownファイルから各AIエージェント（Cursorの.cursor/rules/cursor.mdc、GitHub Copilotの.github/copilot-instructions.mdなど）が必要とする形式に自動変換し、複数の指定ディレクトリへ同時に配置する機能を提供します。これにより、ルール追加・変更時の二重管理や手動更新の煩雑さが解消され、一貫性のあるルール適用が可能になります。

記事では、rulesyncの具体的な導入手順として、Homebrewでのインストール方法（Node.jsのバージョン依存問題を回避するため）、マスターとなる`rulesync/rules/rules.md`ファイルの作成、そして生成対象のエージェントや配置ディレクトリを指定する`rulesync.jsonc`の設定方法を詳述しています。

特にモノレポ環境における課題として、VS Codeなどで特定のパッケージディレクトリを開いた際にAIエージェントがリポジトリルートのルールファイルを参照できず、汎用的な提案しか返さない問題に直面したことが説明されています。この問題に対し、`rulesync.jsonc`の`baseDirs`設定を拡張し、リポジトリルートだけでなく各パッケージディレクトリにもルールファイルを一括生成することで解決しました。これにより、どのディレクトリでエディタを開いても常に共通のルールが適用される環境が実現しました。

さらに、特定のパッケージに固有のルールを設定する際には、マスターMarkdownファイル内で`globs`オプションを使用し、適用対象のファイルパスを指定する手法が紹介されています。運用上の重要なポイントとして、自動生成されたルールファイルはGit管理外（.gitignoreに追加）とし、マスターファイルと`rulesync.jsonc`のみを管理することで、Pull Request時のノイズを減らし、リポジトリをクリーンに保つことが推奨されています。

今後の展望として、新規メンバーが開発に参加した際に手動で`rulesync generate`コマンドを実行する手間を省くため、`package.json`の`prepare`スクリプトに組み込み、開発者が意識せずともルールファイルが自動生成される仕組みを目指していると結ばれています。著者は、rulesyncがAIエージェント間のルール差分解消と開発効率向上に大きく貢献し、特にモノレポ環境の開発チームにとって非常に有効なソリューションであると強調しています。