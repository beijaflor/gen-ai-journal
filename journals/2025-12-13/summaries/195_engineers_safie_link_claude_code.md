## Claude Codeでテスト半自動化：新卒2年目が実践するワークフロー

https://engineers.safie.link/entry/claude-code-test-automation-workflow-subagents

新卒2年目のエンジニアが、大規模なデザインシステム移行に伴う膨大なテストコード作成の課題を解決するため、Claude CodeのSubagentsを活用したテスト半自動化ワークフローを構築し、開発効率と品質の向上を実現しました。

**Content Type**: ⚙️ Tools
**Language**: ja

**Scores**: Signal:4/5 | Depth:4/5 | Unique:4/5 | Practical:5/5 | Anti-Hype:4/5
**Main Journal**: 86/100 | **Annex Potential**: 84/100 | **Overall**: 84/100

**Topics**: [[AIコード生成, テスト自動化, Claude Code, Subagents, 開発ワークフロー]]

セーフィーのフロントエンド開発チームは、大規模なデザインシステム移行によりテストコード作成が膨大になり、単純作業が多いことでエンジニアのモチベーション低下という課題に直面していました。この状況を打破するため、同社は生成AI、特にClaude CodeとSubagentsを用いたテスト半自動化ワークフローを導入しました。

記事では、なぜ「全自動」ではなく「半自動化」を選んだのかを説明しています。以前GitHub Copilot Agentでテストを生成した際、プロジェクト固有のルールが守られず、6〜7割を人間が修正する必要があったため、Subagentsを用いた段階的なアプローチに至ったと著者は述べています。現在のワークフローでは、Claude Codeを「部下」のように位置づけ、テストの実装や新規開発の雛形作成などを任せています。

具体的なワークフローは以下の4ステップで構成されます。
1.  **テスト設計**: `generate-test-spec`エージェントがテスト設計書を作成し、人間のレビューと承認を必須とすることで、プロジェクトの意図との乖離を防ぎます。
2.  **テスト実装**: 承認された設計書に基づき、`implement-test`エージェントがテストコードを実装し、カバレッジ確認とエラー時の自己修正までを自律的に行います。ここでは、固有の命名規則などを厳格に守らせず、純粋な処理に集中させることで精度向上を図っています。
3.  **並列トリプルレビュー**: 実装されたコードに対し、3つの異なる専門家エージェント（構文・非同期処理、DOM操作・マッチャー、SpyOn・モック定義）が並列でレビューを行い、プロジェクト固有のルール準拠などを提案します。これにより、特定の観点に絞った高精度なレビューと実行速度の向上が実現しました。
4.  **統合修正・最終調整**: 3つのレビュアーからの指摘を`consolidate-test-fixes`エージェントが集約し、実際のコード修正に適用。再度テスト実行と設計書との乖離確認を経て完了します。

この半自動化導入により、テスト実装時間は約20%短縮されただけでなく、人間がAIの生成中に他の複雑なタスクに取り組めるようになり、脳のメモリを解放する「時間以上の価値」が生まれたと筆者は強調しています。また、AIがエッジケースを指摘することで、テストの網羅性も向上しました。

著者は、AIを「賢い部下」として活用し、人間はAIの成果物に対して自身の頭で考え、疑い、責任を持つ「思考力」が重要になると結論づけています。AIとの協業が当たり前になる未来において、AIに使われるのではなく、使いこなす側のエンジニアとしての姿勢が問われると提言しています。