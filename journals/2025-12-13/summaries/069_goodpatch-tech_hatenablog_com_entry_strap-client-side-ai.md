## Firebase AI Logicで爆速なAIを実現する。Server Prompt Templatesを添えて。

https://goodpatch-tech.hatenablog.com/entry/strap-client-side-ai

Goodpatchは、オンラインホワイトボード「Strap」において、ユーザー体験を損なわない爆速なAI応答を実現するため、Firebase AI Logicを導入し、プロンプトのセキュリティ課題をServer Prompt Templatesで解決したと発表しました。

**Content Type**: ⚙️ Tools
**Language**: ja

**Scores**: Signal:4/5 | Depth:4/5 | Unique:3/5 | Practical:4/5 | Anti-Hype:4/5
**Main Journal**: 76/100 | **Annex Potential**: 73/100 | **Overall**: 76/100

**Topics**: [[Firebase AI Logic, Server Prompt Templates, クライアントサイドAI, LLMパフォーマンス, プロンプトセキュリティ]]

Goodpatchは、オンラインホワイトボード「Strap」のAI機能強化において、ユーザーが待ち時間で思考を中断しない「爆速レスポンス」の実現が不可欠であると判断し、その技術選定と課題解決のプロセスを解説しています。従来のCloud Functionsを利用したAI実行では、認証処理やAIの生成完了を待つ必要があり、ストリーミングレスポンスを導入してもAIリクエストまでの前処理オーバーヘッドは避けられないため、ユーザー体験の観点から「ワンテンポ遅れる」感覚が残ると筆者は指摘します。

この課題を解決するため、同社はFirebase AI Logic（旧Vertex AI for Firebase）を採用しました。これはクライアント（ブラウザ）から直接Googleのゲートウェイを介してGemini APIを呼び出すことで、自社バックエンドを経由するオーバーヘッドを完全に排除し、体感速度を向上させるアプローチです。App Checkによるクライアント認証が担保されるため、不正アクセスは防げますが、初期の実装ではシステムプロンプトやモデルパラメータがクライアントサイドのJSバンドルに露出してしまうというセキュリティ上の懸念がありました。

このプロンプト漏洩の課題に対し、最近リリースされたFirebase Server Prompt Templatesが有効な解決策となる点を筆者は強調しています。これにより、プロンプトやパラメータをFirebase側で管理し、クライアントからはテンプレートIDと変数のみを送信する形でAIを実行できるようになります。これはプロンプトの秘匿化を実現しつつ、Firebaseコンソールからの簡単な調整も可能にするため、クライアントサイドAIの利便性を大きく高めると評価しています。

また、クライアントサイド実行には速度以外の利点もあり、ユーザーのブラウザメモリ上に存在する最新データを直接AIに渡せるため、サーバーサイドでのDBフェッチ負荷やコストを削減できると説明しています。しかし、同時にコンテキストウィンドウの管理や生成品質の維持のため、情報の選別、構造化、キャッシュといった「コンテキストエンジニアリング」が重要であると述べ、今後の課題として取り組んでいく姿勢を示しています。本稿は、SaaSにおけるAI機能のUX（速度）追求と、それに伴うセキュリティ、コンテキスト管理といった技術的課題への実践的なアプローチを具体的に示しており、webアプリケーション開発者にとって示唆に富む内容です。