## CLAUDE.mdの肥大化を防ぐ！.claude/rules/で動的にルールを読み込む方法

https://zenn.dev/tmasuyama1114/articles/claude_code_dynamic_rules

Claude Codeの`.claude/rules/`機能が、肥大化した`CLAUDE.md`を分割し、必要なルールを動的にロードすることでAIのコンテキスト利用を最適化する仕組みを検証し、その活用法を解説する。

**Content Type**: ⚙️ Tools
**Language**: ja

**Scores**: Signal:4/5 | Depth:4/5 | Unique:3/5 | Practical:5/5 | Anti-Hype:4/5
**Main Journal**: 81/100 | **Annex Potential**: 77/100 | **Overall**: 80/100

**Topics**: [[Claude Code, AI駆動開発, コンテキスト管理, ルール動的ロード, 開発効率化]]

この記事は、Claude Codeユーザーが直面する`CLAUDE.md`の肥大化問題と、それに伴うAIコンテキストの非効率な利用を解決する新機能「`.claude/rules/`」について解説しています。著者は、プロジェクトのルールや規約が`CLAUDE.md`に集中することで、AIが常に不要な情報をロードし、コンテキストを圧迫するという課題を提示します。

`.claude/rules/`機能は、ルールをファイルごとに分割し、必要な時だけ動的にロードする仕組みを提供します。`paths`フィールドをYAMLフロントマターに記述し、Globパターンで対象ファイルを指定することで、そのファイルが操作された際にのみ関連するルールがコンテキストに追加されます。`paths`指定がないルールは起動時に常にロードされますが、指定があるルールはオンデマンドでロードされるため、コンテキストの節約に大きく貢献します。

著者は検証用プロジェクトを構築し、以下の主要な動作を実証しました。
1.  **起動時ロード**: `paths`指定のないルールのみが起動時にロードされ、動的ロード対象のルールは保留される。
2.  **動的ロード**: 特定のファイル（例: `src/index.ts`）を操作すると、関連するルールファイル（例: `typescript.md`）が動的にロードされることを確認。
3.  **複数ルール適用**: 複数の`paths`パターンにマッチするファイル（例: `src/api/handler.ts`）に対して、該当する全てのルールが同時にロードされる。
4.  **重複ロード防止**: 一度ロードされたルールは、同じファイルを再度操作しても再ロードされず、コンテキスト利用の効率性を保つ。
5.  **コンテキスト増加の可視化**: 大容量のルールファイルを動的にロードすることで、AIのコンテキスト使用量が実際に増加することを確認。

これらの検証結果に基づき、著者はフルスタックプロジェクトにおけるフロントエンドとバックエンドのルール分離、テストファイル専用の規約、ドキュメント執筆のスタイルガイドなど、実践的な活用例を提案しています。また、1ファイル1トピックの徹底、`paths`指定の適切な利用、サブディレクトリによる整理といったベストプラクティスも示されています。

著者は、本機能の導入により、大規模なプロジェクトでもAIのコンテキストを効率的に管理し、開発者がより集中して作業できる環境を構築することで、AI駆動開発の生産性向上に寄与すると結論付けています。