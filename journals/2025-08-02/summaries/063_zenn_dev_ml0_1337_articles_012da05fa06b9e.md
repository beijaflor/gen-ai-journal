## Claude Codeで常にコンテクスト残量を表示する方法

https://zenn.dev/ml0_1337/articles/012da05fa06b9e

Claude Codeの使い勝手を向上させるため、ユーザーがインストールファイルを直接編集し、コンテキストのトークン残量を常に表示させる具体的な手法を詳細に解説する。

**Content Type**: Tools

**Scores**: Signal:4/5 | Depth:4/5 | Unique:4/5 | Practical:5/5 | Anti-Hype:5/5
**Main Journal**: 88/100 | **Annex Potential**: 87/100 | **Overall**: 88/100

**Topics**: [[Claude Code, LLMコンテキスト管理, 開発ツールカスタマイズ, CLIツール, 生産性向上]]

Claude Codeは、Anthropicが提供する強力なAIコーディングツールとして開発者の間で注目されていますが、そのコンテキスト管理機能には改善の余地がありました。具体的には、コンテキストの残りトークン数が一定の閾値（20%）を下回るまで表示されないため、ユーザーは大規模なタスクを任せる際や、LLMのパフォーマンスがコンテキスト残量によって変動する状況において、常に「今どれくらいのコンテキストが消費されているのか」「このタスクを続行すると途中でauto-compactが走るか」といった不明瞭さに直面していました。このような情報不足は、人間の脳のコンテキスト（マインドシェア）を圧迫し、非効率な開発につながるという問題がありました。

本記事は、この長年の課題に対し、ウェブアプリケーションエンジニアが自ら解決策を講じるための具体的な手法を提示しています。まず、`npm`でグローバルにインストールされたClaude Codeの内部ファイルである`cli.js`を直接編集することを提案。このファイルは通常ミニファイ（圧縮）されているため、`prettier`を用いて人間が読解可能な形に整形する手順から始まります。その上で、`sed`コマンドを駆使したシェルスクリプトを用いることで、コンテキスト残量の表示条件を恒常的に表示するよう変更し、さらに詳細なトークン数とパーセンテージ（例：「Context tokens remaining: 125,000 (68%)」）が表示されるように改造します。これにより、開発者は自身のワークフローに合わせてコンテキスト使用状況をリアルタイムで把握できるようになります。

このカスタマイズは、Generative AIを日常のコーディングに深く統合するウェブアプリケーションエンジニアにとって、計り知れない実用的な価値をもたらします。コンテキストの正確な可視化は、AIへのより精緻な指示出しを可能にし、無用なトークン消費を避け、LLMの持つ推論能力やコード生成能力を最大限に引き出すことに直結します。結果として、開発中の不確実性や認知負荷が大幅に軽減され、よりストレスなく、かつ効率的なAI活用型開発ワークフローの実現に貢献します。ただし、ツールがアップデートされるたびにこの変更が上書きされる可能性があるため、その都度再適用が必要である点、またプロプライエタリ・ソフトウェアの改変が利用規約（リバースエンジニアリング禁止条項）に抵触する可能性がある点については、利用者が認識しておくべき重要な留意事項です。それでも、日常の生産性を劇的に向上させるための、非常に価値のある技術的ハックと言えるでしょう。