## モジュールを外から見た振る舞いだけAIレビューさせる smoke-review

https://zenn.dev/mizchi/articles/smoke-review-for-filtering-context

AIがモジュールの外部振る舞いのみをレビューする「Smoke Review」手法を提案し、実装バイアスを排除しつつトークン消費を削減します。

**Content Type**: ⚙️ Tools

**Scores**: Signal:5/5 | Depth:4/5 | Unique:5/5 | Practical:5/5 | Anti-Hype:4/5
**Main Journal**: 94/100 | **Annex Potential**: 93/100 | **Overall**: 92/100

**Topics**: [[AIコードレビュー, LLMエージェント, コンテキスト管理, APIデザイン, 実装者バイアス]]

この記事では、AIによるコードレビューにおいて、実装者のバイアス排除とトークン消費量削減を目指す新たな手法「Smoke Review」が提案されています。AIがコード内部の事情を知りすぎると、外部に不要な要素を不用意に露出させがちであるという課題に対し、著者はTDD（テスト駆動開発）の「先に振る舞いを定義する」という思想にヒントを得て、モジュールを外部から見た振る舞いのみをAIにレビューさせるアプローチを考案しました。

具体的には、Anthropicの提供するSubAgents機能を活用し、レビュー対象のモジュールについて、外部に公開される型定義ファイル（`dist/index.d.ts`）と、インテグレーションテストの仕様一覧（`vitest`のテスト結果からスクリプトで抽出）のみをAIに与えます。AIエージェントは実装コードを一切参照せず、あたかもそのライブラリの利用者であるかのように振る舞い、公開APIの完成度、使いやすさ、そしてテストケースの網羅性を評価します。さらに、複数のレビュー用SubAgent（公開APIレビュー、サンプルコードレビュー、統合テストレビュー）を並列で実行することで、レビュープロセス全体の高速化も実現しています。

この「Smoke Review」は、ウェブアプリケーションエンジニアにとって非常に実用的な意義を持ちます。特に、再利用可能なモジュールやライブラリを開発する際、実装者が陥りがちな「実装バイアス」を排除し、最終的な利用者視点でのAPI品質を客観的に高めることが期待できます。また、AIに与えるコンテキストを最小限に抑えることで、大規模なコードベースにおけるLLMのトークン制限問題や推論コストの課題にも対処しようとする現実的なアプローチです。公開されているPoCリポジトリは、自身の開発ワークフローにAIによる効率的かつ高品質なレビューを取り入れたいと考えるエンジニアにとって、具体的な導入可能性を探る上で貴重な実践例となるでしょう。