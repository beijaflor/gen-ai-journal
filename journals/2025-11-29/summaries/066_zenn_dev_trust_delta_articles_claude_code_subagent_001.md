## Claude Codeはサブエージェントが何をしたか知らない

https://zenn.dev/trust_delta/articles/claude-code-subagent-001

Claude Codeのエージェント開発において、サブエージェントが他のサブエージェントの行動履歴を認識しないという仕様上の制約を実証し、エージェント設計における明示的な情報共有の重要性を提示します。

**Content Type**: 🔬 Research & Analysis
**Language**: ja

**Scores**: Signal:4/5 | Depth:4/5 | Unique:4/5 | Practical:4/5 | Anti-Hype:4/5
**Main Journal**: 80/100 | **Annex Potential**: 80/100 | **Overall**: 80/100

**Topics**: [[AIエージェント, Claude Code, サブエージェント, コンテキスト管理, LLM開発]]

この記事は、Claude Codeのサブエージェントが他のサブエージェントが行った行動を認識しないという、AIエージェント開発における重要な制約を具体的な実験を通じて明らかにするものです。筆者は、複数のサブエージェントを使った開発において、各サブエージェントが独立した思考を持ち、他のサブエージェントの実行履歴や現在の状態を知らないという仮説を立て、その検証を行いました。

検証実験では、特定のディレクトリを作成するサブエージェントAと、そのディレクトリを利用しようとするサブエージェントBを構成しました。実験の結果、サブエージェントBはサブエージェントAが既にディレクトリを作成していることを認識せず、自身でディレクトリを作成しようとしてエラーになる挙動を示しました。これは、サブエージェント同士に直接的な実行履歴やコンテキストの共有がないことを明確に示しており、メインエージェントの会話ログに全体の流れが記録されていても、個々のサブエージェントはその情報を自身のコンテキストとして利用できない実態が浮き彫りになりました。さらに、エージェントを再起動しても以前の実行ログは引き継がれないため、サブエージェントの実行ログはセッションごとにクリアされる一時的なものであることも判明しました。

この発見は、ウェブアプリケーションエンジニアがAIエージェントを活用した開発を行う上で、非常に重要な意味を持ちます。エージェントがまるで人間のように自然に共同作業を行うという一般的な期待とは異なり、実際には各サブエージェントは独立した環境でタスクを実行するため、シームレスな連携は期待できません。著者は、サブエージェント間での連携が必要なタスクでは、明示的に作業内容や結果を次のサブエージェントに伝える設計が不可欠であると強調しています。具体的には、前のサブエージェントの出力ファイルを次のサブエージェントに渡す、あるいは共有状態を管理する外部ツールを導入するといった工夫が求められます。この知見は、Claude Codeを用いたエージェントベースのアプリケーション開発において、潜在的な問題を回避し、より堅牢で効率的なシステムを設計するための実践的な指針となります。