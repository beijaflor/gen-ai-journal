## Claude Codeで「細かいコンテクストアクセス制御」をしたらだいたい狙い通りのもの作れるようになった話を2025年の間にしたい

https://note.com/mizkun/n/nc4dbb6ed60c1

開発フローを11ステップに分解し、Claude Codeのフック機能を活用してロールごとにファイルアクセス権限を厳格に制御することで、AIエージェントによる意図しないコード改変や仕様の逸脱を防ぐフレームワーク「VibeFlow」を提案する。

**Content Type**: ⚙️ Tools
**Language**: ja

**Scores**: Signal:4/5 | Depth:4/5 | Unique:4/5 | Practical:5/5 | Anti-Hype:4/5
**Main Journal**: 86/100 | **Annex Potential**: 84/100 | **Overall**: 84/100

**Topics**: [[Claude Code, VibeFlow, AIエージェント, コンテキスト制御, TDD]]

著者によれば、AI駆動の「Vibe Coding」には、無計画な会話によってリポジトリがブラックボックス化し、狙い通りのものを作れなくなるという限界がある。この問題を解決するため、著者はClaude Code上で動作する独自の開発フレームワーク「VibeFlow」を構築した。このフレームワークの核心は、プロンプトによる指示（お願い）ではなく、技術的な「アクセス制御」によってAIの挙動を縛る点にある。

具体的には、ドキュメントやファイルへのアクセス権限を「Must Read（必読）」「Can Edit（編集可）」「Can Create（作成可）」の3種に整理。さらに「Product Manager」「Engineer」「QA Engineer」という3つのロールを定義し、現在の開発ステップに応じて適切なロールと権限を割り当てる設計となっている。

特筆すべきは、Claude Codeの「hooks」機能（PreToolUse）を活用した実装だ。Pythonスクリプトを用いて、許可されていないファイルへの書き込みが発生した際に終了コード「2」を返してツール実行を物理的にブロックする。これにより、例えばエンジニアロールのAIが勝手に仕様書（spec.md）を書き換えてバグを「仕様」として正当化するような、エージェント特有の暴走を確実に防いでいる。

また、開発プロセスを11のステップに分解し、AIにTDD（テスト駆動開発）のサイクルを強制するフローも組み込まれている。人間が介入するチェックポイントを「Issueの妥当性確認」と「最終的な動作確認」の2点に絞ることで、開発効率を維持しつつ、最終的な成果物の品質を担保している。著者は、この仕組みによって中規模な個人開発やプロトタイプ制作において、解釈違いのない「狙い通り」の開発が可能になったと結論付けている。エージェントを自由に動かすのではなく、明確な境界線とフローという「檻」に入れることで、その能力を最大限に引き出す実戦的なアプローチと言える。