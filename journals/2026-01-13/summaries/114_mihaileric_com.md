## クロード・コードを200行で再現：AIコーディングエージェントの仕組みを解剖する

https://www.mihaileric.com/The-Emperor-Has-No-Clothes/

**Original Title**: The Emperor Has No Clothes: How to Code Claude Code in 200 Lines of Code

解明する。わずか200行のPythonコードでClaude Codeと同等の機能を持つエージェントを構築し、AIツールの「魔法」の正体がシンプルなツール利用ループであることを明らかにします。

**Content Type**: 🎭 AI Hype
**Language**: en

**Scores**: Signal:5/5 | Depth:4/5 | Unique:4/5 | Practical:5/5 | Anti-Hype:5/5
**Main Journal**: 93/100 | **Annex Potential**: 93/100 | **Overall**: 92/100

**Topics**: [[Coding Agents, Python, LLM Tool Use, Claude Code, Agentic Workflows]]

昨今、Claude CodeやGitHub CopilotといったAIコーディングアシスタントは、まるで魔法のように複雑なタスクをこなす存在として語られている。しかし、スタンフォード大学での講義も担当するMihail Eric氏は、これらのツールの核心は決して魔法ではなく、わずか200行程度のシンプルなPythonコードで再現可能であると主張している。著者は「裸の王様」という比喩を用い、業界にはびこる過度な神格化に警鐘を鳴らしている。

本記事では、機能的なコーディングエージェントをゼロから構築する過程を通じて、エージェントの本質的なメカニズムを解剖している。その構造は極めて明快だ。ユーザーが指示を出すと、LLMは自身が持つツールボックスの中から適切なツールを選択し、構造化されたツール呼び出し（JSON形式など）をレスポンスとして返す。プログラム側はこの指示をローカル環境で実行し、その結果を再びLLMにフィードバックする。LLMはこの実行結果というコンテキストをもとに、次のアクションを決定するか、タスクの完了を報告する。この「会話と実行のループ」こそが、すべてのAIエージェントの心臓部であると筆者は説明する。

具体的に実装されるツールは、ファイル読み込み、ファイル一覧表示、ファイル編集（作成および置換）のわずか3つだ。著者は、これだけの最小限のセットであっても、ファイルの中身を確認し、関数を修正し、新しいスクリプトを作成するといった高度な対話型開発が可能であることをコード例とともに示している。実装のポイントとして、LLMにツールの使い方を理解させるための「システムプロンプト」の設計や、LLMの返答からツール実行命令を抽出するパーサー、そして処理が完了するまで再帰的にLLMを呼び出し続けるエージェントループが詳説されている。

Webアプリケーションエンジニアにとって、この知見は極めて重要である。AIツールをブラックボックスとして扱うのではなく、その仕組みを「制御可能なコード」として理解することで、独自のワークフローに最適化されたエージェントを自作したり、既存ツールの限界や得意不得意を論理的に判断したりできるようになるからだ。商用ツールにあるエラーハンドリングや複雑なコンテキスト管理などは、あくまで製品としての完成度を高めるための装飾に過ぎない。筆者は、エンジニアがAIという強力な技術を過度に恐れたり崇めたりするのではなく、自分たちの手中に取り戻すための実践的なリアリティ・チェックを提供している。