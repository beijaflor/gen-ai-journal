## A developer’s guide to MCP auth

https://workos.com/blog/mcp-auth-developer-guide

本ガイドは、AIエージェントがアクセスするMCPサーバーのセキュリティを確保するため、OAuth 2.1とPKCE、メタデータ発見、JWT検証、RBACといった最新の認証・認可技術を詳細に解説する。

**Content Type**: 📖 Tutorial & Guide

**Scores**: Signal:4/5 | Depth:5/5 | Unique:3/5 | Practical:5/5 | Anti-Hype:4/5
**Main Journal**: 89/100 | **Annex Potential**: 83/100 | **Overall**: 84/100

**Topics**: [[MCP認証, OAuth 2.1 / PKCE, AIエージェントセキュリティ, JWT検証, RBAC]]

AIエージェントが日々能力を高め、MCP（Multi-Agent Communication Protocol）サーバーを介してより多くのシステムにアクセスするにつれて、セキュリティ、特に認証と認可の課題が極めて重要になります。本ガイドは、これらのエージェントが資金移動、アカウント状態変更、ビルドデプロイといった重要なアクションを実行しうるため、「誰がリクエストを行っているか」そして「何が許可されているか」を明確に把握し、必要に応じて迅速にアクセスを停止できる仕組みの構築が不可欠であると強調します。

MCPサーバーをセキュアにするために、OAuth 2.1およびその関連標準が推奨されます。特に、ローカルLLMアプリケーションのようなクライアント秘密を安全に保管できない「公開クライアント」には、PKCE（Proof Key for Code Exchange）が必須であり、認証コードの傍受による権限昇格攻撃を防ぎます。MCPサーバーはRFC 9728で定義されるProtected Resource Metadataを公開し、サポートするトークン形式、信頼する認証サーバー、利用可能なスコープなどのセキュリティ設定をクライアントに自動で発見させます。同様に、OAuthサーバーはRFC 8414に基づくAuthorization Server Metadataで自身の機能（ログインURL、トークンエンドポイントなど）を提示し、手動設定なしでクライアントが接続できるようになります。

さらに、RFC 7591で規定される動的クライアント登録は、新しいMCPサーバーやクライアントが管理者の手作業なしでエコシステムに柔軟に加わることを可能にします。クライアントが取得したアクセストークン（多くはJWT形式）は、MCPサーバー上でその署名、有効期限、発行者（iss）、対象（aud）、そしてアクションに必要なスコープが厳格に検証されなければなりません。このプロセスは、改ざんされたり不正に取得されたりしたトークンによる無許可アクセスを防ぐために極めて重要です。最終的に、RBAC（ロールベースアクセス制御）を導入し、トークンに含まれるスコープとサーバーで定義されたロールを照合することで、最小権限の原則に基づいたきめ細かいアクセス権限を強制します。

これらの複合的な技術的アプローチ（メタデータ発見、動的登録、OAuth 2.1/PKCE、厳格なJWT検証、RBAC）は、MCP環境において堅牢で相互運用可能、かつ完全に発見可能な認証・認可システムを構築するためのバックボーンとなります。WorkOSのようなプラットフォームを利用することで、開発者はこれらの複雑なセキュリティ要件を効率的に実装し、将来にわたって拡張可能で監査可能なAIエージェント統合をセキュアに展開できます。