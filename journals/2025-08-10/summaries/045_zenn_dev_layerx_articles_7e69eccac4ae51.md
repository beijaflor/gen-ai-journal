## MCPにおけるエンタープライズ向け認可に関する議論の今

https://zenn.dev/layerx/articles/7e69eccac4ae51

Model Context Protocolにおける企業向け認可の現状課題を指摘し、IdP連携による安全な一元管理を実現する新提案SEP-646のメカニズムと導入時の論点を解説します。

**Content Type**: Research & Analysis

**Scores**: Signal:5/5 | Depth:4/5 | Unique:4/5 | Practical:4/5 | Anti-Hype:5/5
**Main Journal**: 87/100 | **Annex Potential**: 87/100 | **Overall**: 88/100

**Topics**: [[Model Context Protocol, エンタープライズ認可, IdP連携, ID-JAG, アクセス制御]]

Model Context Protocol (MCP)における現行の認可仕様は、OAuth 2.1に準拠しつつも、MCPツールとユーザー個人間の認可に留まります。この方式では、企業管理者がMCPツールの利用状況や与えられた権限を把握・制御できず、従業員が理論上可能な全ての操作に対する認可を与えかねないという課題がありました。これにより、意図せぬデータ参照・書き込みといったセキュリティリスクや、組織ポリシーに反する利用が発生する可能性があり、企業導入の障壁となっています。

この課題を解決するため、Oktaの関係者からエンタープライズ向け認可仕様「SEP-646: Enterprise-Managed Authorization Profile for MCP」が提案されています。これは現在ドラフト中のIdentity Assertion JWT Authorization Grant (ID-JAG)の仕組みを基盤とし、認可サーバーが信頼できるIdP（Identity Provider）に認可判断を安全に委譲することを可能にします。これにより、MCPクライアントとIdP間でIDトークンとID-JAGアサーショントークンをやり取りし、その情報を元にMCP認可サーバーがIdPの判断に従ってアクセストークンを発行するという流れが実現されます。

この提案の最大の利点は、企業管理者がIdPを介してMCP関連の認可を一元的に統制・可視化できる点です。例えば、「開発部門のユーザーはGitHub関連リソースへの読み取り権限まで許可し、特定の公認MCPツールのみ書き込み権限も許容する」といった詳細なポリシーを組織全体に適用できるようになります。また、ユーザー側で都度インタラクティブな認可（consent）が不要となるため、安全性と利便性が向上します。

一方で課題も存在します。この仕組みの実現には、MCP認可サーバーとIdP双方での仕様サポートが必須であり、特に重要なのは、社内で利用される全てのMCPツールにおいてID-JAG以外の認可経路を禁止できる設定がMCP認可サーバー側で可能であることです。これが担保されないと、管理者によって把握できない認可が行われるリスクが残ります。さらに、管理者が外部ツールのスコープ体系を正確に理解し、適切に設定する負担も考慮する必要があります。

本提案はエコシステム全体での実装には時間を要すると見られますが、企業ニーズに合致した方向性であり、今後の発展が期待されます。webアプリケーションエンジニアとしては、企業のセキュリティポリシーに準拠しつつ、開発フローにAIを安全に組み込むための重要な一歩となるでしょう。