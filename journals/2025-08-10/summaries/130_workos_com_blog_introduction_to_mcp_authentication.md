## Introduction to MCP authentication

https://workos.com/blog/introduction-to-mcp-authentication

Model Context Protocol（MCP）は、AIエージェントの安全な運用を可能にする認証・認可の仕組みとして、OAuth 2.1とAPIキーの採用とその課題を詳述する。

**Content Type**: 🛠️ Technical Reference

**Scores**: Signal:4/5 | Depth:4/5 | Unique:3/5 | Practical:4/5 | Anti-Hype:5/5
**Main Journal**: 79/100 | **Annex Potential**: 77/100 | **Overall**: 80/100

**Topics**: [[Model Context Protocol, AI Agent Security, OAuth 2.1, API Key Authentication, AI System Authorization]]

AIシステムが外部システムと深く連携するにつれて、安全でコンテキストを意識したインフラの必要性が高まっています。その中心にあるのが、LLMが外部ツールやAPIとセキュアに連携するための標準プロトコルであるModel Context Protocol (MCP)です。MCPは、LLMにセッション間のコンテキスト記憶、ユーザーに代わってアクションを実行するためのスコープ付き権限、そしてツールへの統一された抽象化を提供し、「AIエージェントのHTTP + OAuth」として機能します。

MCPは、AIツール（ホスト）、ホストとサーバー間の通信ブリッジ（クライアント）、実際のロジックを実行するサービス（サーバー）の3つの主要コンポーネントで構成されます。特に、モデル自身がデータベース照会やAPI呼び出しなどのアクションを開始するAI駆動型ワークフローでは、過度なアクセスを防止し、特定タスクへのアクセスをスコープ設定するために、強固な認証と認可が不可欠です。

2025年3月、MCPはOAuth 2.1を認証・認可の標準フレームワークとして採用しました。これにより、PKCE（Proof Key for Code Exchange）によるセキュリティ強化、メタデータディスカバリによる設定の簡素化、動的クライアント登録（DCR）によるスムーズな統合が可能になり、既存のIDインフラとの連携が容易になります。また、APIキー認証も一般的なパターンとして利用され、特にローカル環境でのサービスアクセスや、OAuth Device Flowと組み合わせたユーザーレベル認証に活用されます。

しかし、MCPサーバー側には課題も残ります。仕様では、サーバー自身がフルスペックのOAuth 2.1プロバイダとして機能し、トークン管理やメタデータ公開を行うことが求められており、これが運用上・セキュリティ上の大きな負担となっています。外部IDプロバイダへの完全な委任を望む実装者にとっては、中間認証サーバーとして自身のトークンを発行する要件が二重管理のリスクを生むなど、柔軟性に欠ける点が指摘されています。

今後のMCPの進化では、より階層的でプラグイン可能な認証モデル、委任パターンの明確化、軽量サーバー向けの要件緩和などが議論されており、セキュリティと開発者体験のバランスが追求されるでしょう。このプロトコルの成熟は、より安全で制御可能なAIシステムの実現に不可欠であり、エンジニアがその進化に貢献する重要性を強調しています。