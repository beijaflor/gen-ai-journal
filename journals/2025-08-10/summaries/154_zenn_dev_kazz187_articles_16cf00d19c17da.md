## AIでテキストファイルを書き換える技術

https://zenn.dev/kazz187/articles/16cf00d19c17da

AIエージェントが差分ベースのSEARCH/REPLACEブロック形式を用いてテキストファイルを効率的に編集する技術とその実装方法を解説します。

**Content Type**: 📖 Tutorial & Guide

**Scores**: Signal:4/5 | Depth:4/5 | Unique:4/5 | Practical:5/5 | Anti-Hype:5/5
**Main Journal**: 89/100 | **Annex Potential**: 88/100 | **Overall**: 88/100

**Topics**: [[AIエージェント, テキスト編集, 差分ベース編集, プロンプトエンジニアリング, Amazon Bedrock]]

AIエージェントがテキストファイルを書き換える際の効率性と正確性を高める技術として、「差分ベースの編集」が注目されています。従来のAIによるテキスト生成では、ファイルの全文を再生成する方法が一般的でしたが、これはトークン消費量の多さ、元の良い部分の意図しない上書き、レビューの困難さといった課題を抱えていました。

本記事では、これらの問題を解決するために、AiderやClineといったオープンソースのAIエージェントが採用している「SEARCH/REPLACEブロック形式」を活用するアプローチを紹介します。この形式の最大の特徴は、一般的な差分形式が行番号に依存するのに対し、AIが誤った行番号を出力するリスクを回避するため、変更箇所の前後数行のコンテキストを正確に含める点にあります。これにより、AIは行番号に縛られず、文脈に基づいて確実に変更を適用できます。

具体的な実装では、AIへのプロンプトにおいて、検索テキストの「厳密な一致」と、前後3〜5行の「十分なコンテキストの包含」を強く要求します。また、インデントや書式の厳密な保持、対象箇所のみの的確な変更、そして複数箇所に対する複数ブロックの提供といった「重要要件」を明確に指示することが成功の鍵です。

Go言語とAmazon Bedrock (Claude Sonnet 4) を用いたサンプルコードでは、この手法がYAMLファイルのポート番号変更という具体的なタスクで効果的に機能することを示しています。この技術は、AIエージェントの「ブラックボックス」的な側面を解明し、単にツールを使うだけでなく、その内部動作を理解し、自身のカスタムスクリプトや既存システムへの柔軟な組み込みを可能にすることで、AIを活用した開発ワークフローの自動化と効率化を次のレベルへと押し上げます。これにより、ウェブアプリケーションエンジニアは、より洗練された自動化エージェントを構築し、ルーティンワークから解放される道が開かれます。