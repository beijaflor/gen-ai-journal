## 知っておくべきプロンプトインジェクションの脅威と対策

https://qiita.com/Dinn/items/a90428fd6a62ba551f6f

LLMアプリケーションの重大なセキュリティ脅威であるプロンプトインジェクションに対し、その多様な攻撃手法と、カナリアトークン、悪意プロンプトのRAG構築、DAREテンプレートといった具体的な防御策を詳解する。

**Content Type**: Tutorial & Guide

**Scores**: Signal:4/5 | Depth:4/5 | Unique:3/5 | Practical:5/5 | Anti-Hype:4/5
**Main Journal**: 85/100 | **Annex Potential**: 79/100 | **Overall**: 80/100

**Topics**: [[プロンプトインジェクション, LLMセキュリティ, OWASP Top 10, AI攻撃手法, セキュリティ対策]]

LLM活用が急速に広がる中、最も深刻なセキュリティリスクとしてOWASPの「LLMアプリケーションのトップ10脆弱性」で第1位に挙げられたプロンプトインジェクションは、開発者が今すぐ理解し、対策を講じるべき脅威です。従来のSQLインジェクションと異なり、LLMがシステム指示とユーザー入力を区別できないという本質的な特性を悪用し、自然言語で悪意ある指示を注入し、予期せぬ動作を誘発します。

主な攻撃手法として、倫理的制限を回避し機密情報を引き出そうとする「役割上書き攻撃（ジェイルブレイク）」、部分的な情報でLLMを混乱させ偽情報を生成させる「ハルシネーション誘発」、無害な部分を組み合わせて後から悪用する「分割型インジェクション」、そして「フィクション」と偽り制限を迂回する「シナリオ偽装」があります。これら巧妙な手口は、LLMの応答を乗っ取り、情報漏洩や誤情報拡散といった実害を引き起こす可能性があります。

本稿は、これらの脅威に対する具体的な防御策を提示します。第一に、システムプロンプトに特殊な識別子を埋め込み、出力にそれが含まれるか検証することで悪意ある上書きを検出する「カナリアトークン」の使用。第二に、既知の悪意あるプロンプトパターンをデータベース化し、類似度検索で検知・拒否する「悪意プロンプトのRAG構築」。そして第三に、LLMが応答前に自身のミッション遵守や機密情報開示の有無を自己チェックするよう促す「DARE（Directive Adherence Reinforcement Enhancement）テンプレート」を用いたプロンプト設計です。

これらの対策はプロンプトインジェクションの完全な防御を保証するものではありませんが、現実的なリスク軽減には不可欠です。開発者は、LLMの特性を理解し、これらの具体的な防御策を適切に実装し、継続的に改善していくことで、進化する脅威に対して堅牢なLLMアプリケーションを構築する責任があります。これは、単なる技術的課題に留まらず、AI時代のセキュリティ基盤を築く上で避けては通れない道です。