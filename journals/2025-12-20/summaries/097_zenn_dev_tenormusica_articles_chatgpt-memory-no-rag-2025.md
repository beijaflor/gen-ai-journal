## ChatGPTの記憶システムはRAGを使っていなかった - 4層アーキテクチャの衝撃

https://zenn.dev/tenormusica/articles/chatgpt-memory-no-rag-2025

ChatGPTの記憶システムは、多くの予想に反してRAGやベクトルデータベースを使用せず、シンプルな4層構造のコンテキスト注入方式を採用し、高速応答とモデルスケーリングを優先している。

**Content Type**: ⚙️ Tools
**Language**: ja

**Scores**: Signal:4/5 | Depth:4/5 | Unique:4/5 | Practical:4/5 | Anti-Hype:4/5
**Main Journal**: 80/100 | **Annex Potential**: 80/100 | **Overall**: 80/100

**Topics**: [[ChatGPT, LLM記憶システム, RAG, コンテキストウィンドウ, AIセキュリティ]]

ChatGPTの記憶システムが、多くのAI開発者の予想に反し、RAG（Retrieval-Augmented Generation）やベクトルデータベースを使用せず、シンプルな4層構造のコンテキスト注入方式を採用していることが、Manthan Guptas氏のリバースエンジニアリング調査で明らかになりました。この設計は、速度と効率性を最優先したOpenAIの戦略を明確に示しています。

ChatGPTのメモリは以下の4層構造で構成されます。
1.  **エフェメラル（一時的）セッションメタデータ**: デバイスタイプやタイムゾーンなど、セッションごとに注入される情報。
2.  **明示的な長期記憶（33個の事実）**: ユーザーが指示または承認した、名前や目標といった重要な情報のみを厳選して保存。記憶の肥大化を防ぎ、高速応答を維持します。
3.  **最近の会話サマリー（軽量ダイジェスト）**: 約15件の会話をタイトルとスニペットで保持し、計算コストを抑制。
4.  **現在のセッションメッセージ（スライディングウィンドウ）**: 現在の会話メッセージ群をトークン数で調整し、コンテキストウィンドウに収めます。

OpenAIがRAGを選ばなかった理由は、RAGが抱えるエンベディング生成とベクトル検索のレイテンシ、精度問題、システムの複雑化によるメンテナンスコストといった課題を回避するためです。彼らの哲学は、「強力なモデルに大量のコンテキストを渡せば、モデルが勝手に必要な情報をフィルタリングする」という「The Bitter Lesson」の実践にあります。これは、モデルのスケーリングとGPT-4oで128Kトークンに達する巨大なコンテキストウィンドウの活用に賭ける戦略です。このシンプルなアプローチにより、検索ステップを省き、高速な応答を実現し、日常的なChatGPTの利用体験に直結しています。

この設計により、ChatGPTは高速応答を実現する一方で、明示的な記憶は33個に制限され、古い記憶は自動更新されないため、ユーザーによる定期的な管理が重要になります。

競合AI（Claude、Gemini）と比較すると、メモリ機能のアプローチは異なります。Claudeはプロジェクト単位のメモリと巨大コンテキストウィンドウで補完し、Geminiは有料プラン限定の手動登録方式ですが、Gemini 2.0は2Mトークンの圧倒的なコンテキストウィンドウを持ちます。日常会話の記憶継続性ではChatGPTが優位ですが、単一会話の情報処理量では競合の巨大コンテキストウィンドウが突出します。

また、この記憶システムにはセキュリティ上の懸念も存在します。「SpAIware」と呼ばれるMemory Injection攻撃は、悪意ある指示が永続的な記憶として保存され、会話が盗聴されるリスクを指摘しており、機密情報は一時的なチャットモードでの利用が推奨されます。

RAGとシンプルコンテキスト注入の比較では、文献理解ベンチマークでロングコンテキストICL（全部渡す方式）がRAGを上回る結果も示され、性能面でシンプル注入が優位なケースがあります。RAGは構築・運用コストが膨大ですが、シンプル方式はモデル進化に乗じて性能が向上する利点があります。SQLベースのメモリエンジンなど、ベクトル検索以外の代替手段も登場しており、エンジニアはタスクの性質に応じて最適なメモリアーキテクチャを選定する重要性を認識すべきです。

この調査は、必ずしも複雑な最先端技術が最適解ではなく、強力なモデルとシンプルな設計を組み合わせることで、特定のユースケースで高い性能と使いやすさを実現できるという「The Bitter Lesson」を再確認させるものです。