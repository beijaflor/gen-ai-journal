## Claude Code の LSP サポート

https://azukiazusa.dev/blog/claude-code-lsp-support/

拡張しました：ターミナル型 AI エージェント「Claude Code」が LSP（Language Server Protocol）に対応し、コードの構造を理解した高度なナビゲーションや編集を可能にしました。

**Content Type**: ⚙️ Tools
**Language**: ja

**Scores**: Signal:4/5 | Depth:4/5 | Unique:3/5 | Practical:4/5 | Anti-Hype:4/5
**Main Journal**: 78/100 | **Annex Potential**: 72/100 | **Overall**: 76/100

**Topics**: [[Claude Code, LSP, コーディングエージェント, TypeScript, 開発ツール]]

Claude Code のバージョン 2.0.74 において、LSP（Language Server Protocol）のサポートが開始されました。これにより、AI エージェントがコードベースを単なるテキストの集合としてではなく、関数、クラス、変数といったセマンティック（意味論的）な構造体として認識することが可能になります。筆者は、この機能拡張がコーディングエージェントのタスク遂行能力を劇的に向上させると説いています。具体的には、従来の単純な文字列検索に依存したアプローチを脱却し、LSP を通じて正確なシンボル情報にアクセスすることで、探索時間を大幅に短縮し、結果として API のトークン消費量を節約できるという実利的な重要性を強調しています。

機能面では、IDE に匹敵する高度なナビゲーションがエージェントに解放されます。具体的には、シンボルの定義元を特定する「goToDefinition」、プロジェクト全体から参照箇所を洗い出す「findReferences」、型情報やドキュメントを表示する「hover」に加え、インターフェースの実装検索や呼び出し階層の取得など、計 9 種類以上の強力な操作がエージェント側のツールとして利用可能になりました。利用にあたっては、Claude Code 内で `/plugin` コマンドを実行し、公式マーケットプレイスから言語別の LSP プラグインをインストールする形式をとっています。現時点で C/C++、Go、Python、Rust、Swift など多様な言語がリストアップされており、開発現場での即戦力としての期待が高まります。

さらに、本記事の特筆すべき点は、拡張性と現状の技術的制約への言及です。筆者は公式未対応の言語であっても、ユーザー自身が `.lsp.json` 構成ファイルを含むカスタムプラグインを作成することで、既存の LSP サーバーを統合できる手順を具体的に解説しています。一方で、最新の v2.0.74 ではプラグインの初期化タイミングに起因する既知のバグ（レースコンディション）が存在し、一部の環境で LSP ツールが正常にロードされない問題があることも報告されています。これに対し、筆者は安定動作を優先させるため、あえて特定の旧バージョン（v2.0.67）を使用し、環境変数を明示的に付与して起動するという実践的なワークアラウンドを提示しています。ツールを単に紹介するだけでなく、動かすための「現場の知恵」を共有している点が本稿の大きな価値です。