## Effective context engineering for AI agents

https://www.anthropic.com/engineering/effective-context-engineering-for-ai-agents

Anthropicは、AIエージェントのパフォーマンス最適化のため、最適化されたプロンプト、効率的なツール、適応的なメモリシステムなどの戦略を通じて、限られたコンテキストウィンドウを戦略的に管理する「コンテキストエンジニアリング」を定義する。

**Content Type**: ⚙️ Tools

**Scores**: Signal:5/5 | Depth:4/5 | Unique:4/5 | Practical:5/5 | Anti-Hype:4/5
**Main Journal**: 89/100 | **Annex Potential**: 87/100 | **Overall**: 88/100

**Topics**: [[AIエージェント, コンテキストエンジニアリング, プロンプトエンジニアリング, LLMワークフロー, メモリ管理]]

Anthropicは、プロンプトエンジニアリングの次なる進化として「コンテキストエンジニアリング」を提唱しています。これは、大規模言語モデル（LLM）が持つ限られた注意資源（コンテキストウィンドウ）を最大限に活用し、AIエージェントの望ましい振る舞いを一貫して引き出すための戦略を指します。LLMはコンテキストが長くなるにつれて情報想起能力が低下する「コンテキスト腐敗」や、トークン数が増えるほど計算コストがn²で増大する構造的制約があるため、コンテキストを有限かつ貴重な資源として扱う必要があります。

ウェブアプリケーションエンジニアにとって、このアプローチはより堅牢で自律的なAIエージェントを構築するために不可欠です。単にプロンプトの言葉を選ぶだけでなく、エージェントに「何を見せるか」というコンテキスト全体の管理に焦点を当てるパラダイムシフトを意味します。具体的な手法として、以下が挙げられます。

1.  **システムプロンプトの最適化**: 具体的でありながら柔軟性を持つ「Goldilocks zone」を目指し、XMLタグやMarkdownヘッダーで構造化された最小限かつ十分な情報を提供することで、エージェントの挙動を効果的にガイドします。
2.  **ツール設計の効率化**: エージェントが環境と連携するためのツールは、機能の重複を避け、自己完結的で明確な機能を持つように設計します。これにより、エージェントが適切なツールを選択しやすくなります。
3.  **ジャストインタイムでのコンテキスト取得**: 事前処理された全てのデータを渡すのではなく、ファイルパスやWebリンクなどの軽量な識別子を介して、必要に応じて動的に情報をコンテキストに読み込む手法です。AnthropicのClaude Codeは、このアプローチで大規模なデータ分析を行い、人間がファイルシステムを利用するのと同様に効率的な情報探索を可能にします。
4.  **長期間タスクのための技術**: コンテキストウィンドウを超えた長期のタスクに対応するため、以下の戦略を提案しています。
    *   **要約（Compaction）**: 会話履歴を要約し、最も重要な詳細を保持して新しいコンテキストを再開します。冗長なツール出力などは破棄します。
    *   **構造化されたメモ作成（Structured Note-taking）**: エージェントがコンテキストウィンドウ外に永続的にメモを書き込み、後で参照するメモリ機能です。ClaudeがPokémonをプレイする事例で、長期的な目標達成に貢献しています。
    *   **サブエージェントアーキテクチャ**: 主要エージェントが高レベルの計画を調整し、専門化されたサブエージェントがそれぞれクリーンなコンテキストで特定のタスク（例: 詳細な調査）を実行し、その結果を要約して主要エージェントに返すことで、複雑な問題に対処します。

これらの手法を適用することで、開発者はLLMの限界を克服し、より複雑で実用的なAIエージェントを設計・実装できるようになります。