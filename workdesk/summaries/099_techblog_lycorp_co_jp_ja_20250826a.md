## AIで生成された画像をどのように評価するのか？（ブラックボックス最適化適用編）

https://techblog.lycorp.co.jp/ja/20250826a

LINEヤフーは、社内デザインスタイルに合致する画像を効率的に生成するため、ブラックボックス最適化と多種多様な評価指標を組み合わせたAI画像生成の最適化手法を開発しました。

**Content Type**: 🛠️ Technical
**Scores**: Signal:5/5 | Depth:5/5 | Unique:4/5 | Practical:4/5 | Anti-Hype:4/5
**Main Journal**: 90/100 | **Annex Potential**: 87/100 | **Overall**: 88/100

**Topics**: [[Generative AI, Image Generation, Diffusion Models, Black-box Optimization, Hyperparameter Tuning, Image Quality Metrics]]

LINEヤフーは、社内デザイナーの反復作業を軽減するため、プロンプトベースで特定のデザインスタイルに合致する画像を生成するText-to-Imageモデルの開発に着手しました。しかし、「良い画像」の一貫した生成は難しく、膨大なハイパーパラメータ調整が課題でした。

この記事では、この課題解決に向けた効率的なAI画像生成最適化手法を詳細に解説しています。まず、Diffusionモデル（Stable Diffusion, SDXL, SD3.5）の仕組みを説明し、特にSD3.5で採用された決定論的なフローマッチング方式に触れています。次に、画像生成の品質に影響を与えるシード、プロンプト、CFG（Classifier-Free Guidance）、RG（Reward Guidance）、LoRAスケールといった主要なハイパーパラメータの役割を解説。これらの手動調整が非効率であることを示唆します。

効率的な最適化のため、同社は画像を自動評価する仕組みと、ブラックボックス最適化を導入しました。自動評価には、プロンプトとの整合性を測るCLIP Score/VQA Scoreと、質的完成度を測るHPS-V2/Pick Scoreの4指標を組み合わせ、スケール正規化を実施。また、生成される画像の「主題無視・主題混合」問題を軽減するため、損失測定に基づいた「良いシード」選定方法を確立しました。これらの基盤の上に、画像スコアを返す関数をブラックボックス関数と見立て、CFG、RG、LoRAスケールの探索空間において、ベイジアン最適化を用いて最適なハイパーパラメータを効率的に探索しました。

結果として、自動評価と統計的探索の導入により、画像生成プロセスの自動化と信頼性の高い結果取得を実現し、リソースの効率化に成功しました。一方で、ブラックボックス探索による画像の多様性が広すぎること、評価指標が社内スタイルへの合致度を完全には捉えきれない点、ハイパーパラメータ間の独立性の問題など、今後の課題も明確になっています。Webアプリケーションエンジニアにとって、この事例は生成AIをプロダクトに組み込む際の具体的な課題と解決アプローチを示すものです。特に、AI生成物の品質管理、ハイパーパラメータチューニングの自動化、そして評価指標の設計と正規化といったMLOps的な手法は、AIモデルを実運用する上で不可欠な知見を提供します。また、人間による評価が難しい大量の生成物に対して、自動評価と最適化を組み合わせることで開発・運用の効率を大幅に高められる可能性を示しており、AIを活用したサービス開発の具体策を考える上で非常に示唆に富んでいます。