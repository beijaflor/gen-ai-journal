## AIコードレビューを自作する方法

https://semaphore.io/blog/ai-code-review

**Original Title**: DIY AI Code Review

本記事は、既存のCIパイプライン内でシンプルなBashスクリプトとAI APIを活用し、カスタムのAIコードレビュー機能を構築する方法を解説しており、費用対効果と柔軟な制御を実現します。

**Content Type**: ⚙️ Tools
**Language**: en

**Scores**: Signal:4/5 | Depth:3/5 | Unique:3/5 | Practical:5/5 | Anti-Hype:4/5
**Main Journal**: 77/100 | **Annex Potential**: 73/100 | **Overall**: 76/100

**Topics**: [[AI Code Review, CI/CD, LLM Integration, Automation, Developer Tools]]

本記事は、高価な商用AIコードレビュープラットフォームに依存することなく、既存のCIパイプライン内で独自のAIコードレビューシステムを構築する実用的な方法を提案しています。著者は、多くの商用AIレビューツールが、開発者が自身で呼び出せるAI APIをラップしているに過ぎず、高額な料金、ダッシュボード、不必要な制限を伴うと指摘しています。その代わりに、Bashスクリプトと任意のAI API（OpenAIやAnthropicなど）を組み合わせることで、レビューの対象、フィードバック形式、プロンプト、ルール、閾値を完全に制御できると主張しています。

このDIYアプローチは、主に以下の3つのステップで構成されます。
1.  **ファイル選択**: レビュー対象を、プルリクエストで変更されたファイルのみに限定することで、CIの実行を効率化します。`git diff --name-only "$SEMAPHORE_GIT_COMMIT_RANGE"`のようなコマンドを使用して、変更されたファイルパスのリストを取得し、ファイル拡張子やディレクトリでフィルタリングすることが可能です。
2.  **AIによるレビュー依頼**: 選択したファイルを`curl`コマンドでAI APIエンドポイントに送信します。著者は、プロンプト内でAIに「シニアコードレビュアー」としての役割を与え、セキュリティ、パフォーマンス、保守性、ドキュメントなど、レビューの優先順位をカスタマイズできると強調しています。また、結果の自動解析のためには、JSONやJUnit XMLのような構造化された出力をAIに要求することが重要です。
3.  **結果の処理**: AIからの応答をCI内で解析し、実用的なアクションに変換します。例えば、JUnit XML形式の出力であれば、SemaphoreのようなCI/CDツールのテストレポートダッシュボードで視覚化したり、問題が多すぎる場合にパイプラインを失敗させる閾値ルールを設定したりすることができます。

著者は、このカスタムAIコードレビューの構築は、CIパイプラインにインテリジェントな自動化を低コストで導入する、楽しく実用的な方法であると述べています。また、フィードバックの形式や問題発生時の対応を自由に決定できる点が大きなメリットであり、時間と労力はかかるものの、最終的には満足のいくレビューシステムを構築できる価値があるとして、紹介されているデモリポジトリを参考に実験を始めることを推奨しています。