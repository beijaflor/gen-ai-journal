## Claude Codeのコンテキストを節約する

https://zenn.dev/karaage0703/articles/1f30a572ff8460

Claude Codeのユーザーが直面するコンテキスト不足問題を解消するため、著者は具体的なトークン削減策と効果的な管理方法を共有します。

**Content Type**: ⚙️ Tools
**Language**: ja

**Scores**: Signal:4/5 | Depth:4/5 | Unique:4/5 | Practical:5/5 | Anti-Hype:5/5
**Main Journal**: 88/100 | **Annex Potential**: 87/100 | **Overall**: 88/100

**Topics**: [[Claude Code, AIコーディング, コンテキスト管理, トークン削減, MCPサーバー]]

AIコーディングツールとしてClaude Codeを主に使用している著者は、コンテキストが一杯になった際に表示される「Compacting Conversation...」というメッセージに頻繁に遭遇し、これが作業のストレス要因となっていると指摘します。このメッセージは処理の遅延を引き起こし、AIの指示理解度を低下させるため、著者はコンテキストの節約が急務だと感じました。

著者が`/context`コマンドで確認したところ、コンテキスト使用率が69%に達していることが判明し、この高い使用率が頻繁な圧縮の原因であることを理解しました。この問題に対処するため、著者は主に以下の3つの具体的なトークン削減策を実行しました。

まず、不要なMCPサーバーを無効化する戦略です。`/context`コマンドの分析から、多くのMCPサーバーが大量のトークンを消費していることが明らかになりました。著者は、プロジェクトごとに`.mcp.json`ファイルを設定してMCPサーバーを切り替えるか、自身が開発したOSSツール`ccmcp`を使ってグローバルに切り替える方法を提案しています。

次に、自作したMCPサーバーの使用トークン数を削減しました。過去のブログ記事を取得する目的で作成したMCPサーバーのコードを見直し、不必要にトークンを消費している箇所を修正することで、機能性を損なうことなくトークン量を半減させることに成功しました。著者は、自作MCPサーバーを利用している読者にも同様のチェックを推奨しています。

最後に、メモリファイルの削減です。「SuperClaude」というツールをセットアップした際に導入された、内容不明なプロンプトファイルがトークンを消費していることを発見し、これらを削除することでトークン使用量を削減しました。

これらの施策の結果、著者はClaude Codeのトークン使用量を69%から39%まで削減し、実質的な使用量はバッファを除けば18%にまで改善できたと報告しています。頻繁にコンテキスト圧縮に悩まされているClaude Codeユーザーや、多くのMCPサーバーやプラグインを導入しているユーザーに対し、著者は`/context`コマンドでの現状確認を強く推奨しています。