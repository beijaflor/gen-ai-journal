## MCPアポカリプスを告げる5つの脅威：AIエージェント連携におけるセキュリティの落とし穴

https://foojay.io/today/the-5-knights-of-the-mcp-apocalypse/

**Original Title**: The 5 Knights of the MCP Apocalypse 😱

MCPサーバー導入に伴う5つの主要なセキュリティリスクを特定し、ネットワーク隔離や静的・動的解析などの具体的な防御策を提示する。

**Content Type**: Technical Reference
**Language**: en

**Scores**: Signal:5/5 | Depth:4/5 | Unique:4/5 | Practical:5/5 | Anti-Hype:4/5
**Main Journal**: 89/100 | **Annex Potential**: 94/100 | **Overall**: 88/100

**Topics**: [[MCP, AI Security, Agentic Workflow, Network Isolation, LLM Security]]

AIエージェントにライブデータや内部ツールへのアクセスを許可する「Model Context Protocol (MCP)」は強力な武器だが、サードパーティ製やオープンソースのMCPサーバーを「中身のわからないブラックボックス」として導入することには甚大なリスクが伴う。筆者は、このセキュリティ上の脅威を「アポカリプスの5人の騎士」になぞらえ、エンジニアが「監査人」の視点で取り組むべき5つの重要課題と対策を詳説している。

1. **プロンプト経由の機密情報漏洩**: 開発者がデバッグ中に本番環境の認証情報をプロンプトに貼り付け、それがMCPサーバーのログに永続化されるリスク。対策として、ローカルLLMの活用や、PII（個人情報）を自動的に匿名化するプロキシ（Philleas等）、入力ガードレールの導入を挙げている。
2. **「二重スパイ」サーバー**: 見た目だけを模倣した非公式のMCPサーバーが、内部でデータを外部へ転送したり、書き込み権限を悪用してデータを破壊したりするリスク。DockerやKubernetesのNetworkPolicyを用いた厳格なエグレス（送信）通信制限によるネットワーク隔離が不可欠である。
3. **脆弱性のブラックボックス**: MCPサーバー自体が抱えるLog4jやSpringの脆弱性。SCA（ソフトウェア構成分析）による依存関係の脆弱性スキャンと、DAST（動的解析）によるAPIエンドポイントの防御確認を「妥協できない要件」としている。
4. **コンテキスト汚染と毒入れ**: 不要なデータの大量注入（汚染）によるコスト増と精度低下、あるいは悪意あるデータ注入（毒入れ）による回答操作のリスク。特定のタスクにのみMCPサーバーを割り当てるサブエージェント構造や、LLMが直接ツールを叩くのではなく安全なサンドボックス内でコードを実行して結果のみを返す手法が有効である。
5. **MCPサーバーの乱立（ス sprawl）**: 各チームが個別にサーバーを立てることで攻撃表面が拡大する問題。組織横断的な「AIゲートウェイ」やサービスカタログを整備し、認証情報の管理とセキュリティポリシーを中央集約化することを推奨している。

筆者は、MCPサーバーをブラウザのプラグインのように安易にインストールする風潮に警鐘を鳴らしている。便利なツールが企業情報の「巨大な漏洩口」にならないよう、隔離・監視・監査を徹底する実務的なアプローチを提示している。