## 業務で進むLLM活用、その裏に潜む脅威とは？Microsoft 365 Copilotを介した攻撃検証（インターン体験記）

https://engineers.ntt.com/entry/202511-offsec-intern-1/entry

NTTドコモグループのインターンシップでMicrosoft 365 Copilotの潜在的なセキュリティ脅威を攻撃者視点で検証した結果、悪意のあるリンク誘導が可能であることを報告する。

**Content Type**: Research & Analysis
**Language**: ja

**Scores**: Signal:4/5 | Depth:4/5 | Unique:4/5 | Practical:4/5 | Anti-Hype:5/5
**Main Journal**: 83/100 | **Annex Potential**: 84/100 | **Overall**: 84/100

**Topics**: [[LLMセキュリティ, Microsoft 365 Copilot, プロンプトインジェクション, Offensive Security, 攻撃検証]]

NTTドコモグループのインターンシップにて、大規模言語モデル（LLM）の業務利用が進む中で、Microsoft 365 Copilotに潜むセキュリティ上の脅威を明らかにするための攻撃検証が実施された。筆者はOffensive Securityプロジェクトの一員として、攻撃者視点からCopilotを介した悪意のあるサイトへの誘導手法を検証している。

まず、Black Hat USA 2024で報告された手法の再現を試みたが、Copilot側の対策強化（ハイパーリンク形式の制限やクロスプロンプトインジェクション攻撃分類器による検知）により、初期の攻撃は成功しなかった。これは、Copilotが信頼できないリンクをハイパーリンクとして表示しない、または悪性指示として認識するためである。

次に、この対策を回避するため、ユーザー向けの案内文にMarkdown形式で不正なURLを埋め込む手法を検証した。結果として、PlainText形式のメールを参照した場合にはクリック可能なハイパーリンクとして応答されたが、HTML形式では成功しなかった。筆者は、CopilotがHTML形式のメールにおいて、ユーザーを誤認させやすい形式への警戒を強めている可能性を指摘している。

さらに、攻撃者がペイロード（悪意のあるURL）を隠蔽する手法として、Copilotが参照可能なSharePoint上のExcelファイルに白文字で不正なURLを記載する検証を行ったところ、Copilotはこれを参照し、意図通りハイパーリンクとして応答することに成功した。

これらの検証から、Copilotが正規のリンク名で悪意のあるURLを応答させ、広範囲の利用者を悪意のあるサイトへ誘導する可能性が示唆された。ペイロードの隠蔽には、PlainTextメールのように発覚しやすいが容易な方法と、SharePoint上のExcelファイルのように配置権限が必要だが視認されにくい方法のトレードオフが存在する。筆者は、防御側がCopilotの参照元情報やペイロードが隠されうる場所を正確に把握し、「先回りの防御」を講じることの重要性を強調している。また、LLMの予測不能な挙動も含め、セキュリティ分野の面白さと、攻撃者視点の重要性を再認識したと述べている。