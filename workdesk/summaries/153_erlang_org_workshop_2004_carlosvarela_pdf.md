## Erlangで構築するマルチエージェントシステム - BDIモデルと関数型プログラミングの融合がもたらす耐障害性

https://erlang.org/workshop/2004/carlosvarela.pdf

**Original Title**: On Modelling Agent Systems with Erlang

スペイン・ア・コルーニャ大学の研究チームが、Erlangの並行処理・分散処理機能を活用してBDI（Belief-Desire-Intention）モデルに基づくマルチエージェントシステムを構築し、プラン交換による協調、動的再構成、耐障害性を実現する実装ガイドラインを提示する。

**Content Type**: 📚 Research & Analysis
**Language**: en

**Scores**: Signal:3/5 | Depth:4/5 | Unique:4/5 | Practical:4/5 | Anti-Hype:5/5
**Main Journal**: 75/100 | **Annex Potential**: 80/100 | **Overall**: 78/100

**Topics**: [[マルチエージェントシステム, Erlang, BDI, 分散システム, 耐障害性]]

2004年9月、Carlos Varelaらア・コルーニャ大学MADS GroupがErlang Workshop 2004で発表したこの論文は、関数型プログラミング言語Erlangを用いてマルチエージェントシステムを構築する際の設計指針を示しています。マルチエージェントシステムは並行分散システムの一種であり、Erlangの通信メカニズム、マルチスレッド機能、耐障害性といった特性が、エージェントシステムの実装に適していると著者らは主張します。

本研究の中核となるのは、**BDI（Belief-Desire-Intention）モデル**の実装です。BDIモデルでは、エージェントは以下の3要素を持ちます：(1) Beliefs（信念）：エージェントが持つ世界に関する情報（不完全または不正確な場合もある）、(2) Desires（欲求）：エージェントが実現したい状態、(3) Intentions（意図）：エージェントが達成にコミットした欲求。著者らはこれらをErlangのタプル形式 `{Name, Param}` で表現し、例えば `{fire, {100,10}}` が座標(100,10)での火災を表します。

**エージェントのアーキテクチャ**は、プロセスの集合として実装されます。初期状態では4つのプロセスが存在します：(1) イベント受信プロセス（外部メッセージのフィルタリング）、(2) 状態サーバ（ゴール、意図、信念、内部状態の管理）、(3) エグゼキュータ（プランの実行とアクションの遂行）、(4) メインプロセス（イベント受信、信念更新、アクション・ゴール生成、実行）。これはgen_serverビヘイビアを使用して実装されます。

**プラン（Plan）**は、ゴールを達成するための手順を記述します。Erlangのレコードとして表現され、以下の要素を持ちます：trigger（プラン実行のトリガーとなるゴール）、precondition（プラン実行前に真でなければならない条件）、postcondition（プラン完了時に真でなければならない条件）、invariant（プラン実行中常に真でなければならない条件）、body（実行するアクションとゴールの順序）。例えば、消火ロボットのプランでは、火災地点への経路計画、移動、消火という一連のステップが定義されます。

**協調（Cooperation）メカニズム**により、エージェントは未知のイベントに対処できます。エージェントがイベントへの応答を持たない場合、協調エージェントリストに問い合わせ、ルールやプランを取得します。ただし、自身が実行できないアクションを含む応答は拒否されます。このメカニズムにより、エージェントは動的に能力を拡張できます。

**再構成（Reconfiguration）機能**は、システムの実行中に動的な変更を可能にします。2種類の新しいエージェント、ManagerとReconfiguration Agentが導入されます。Reconfiguration Agentは、start/stop/suspend/resume/shutdownといったライフサイクル制御インターフェースを提供し、内部状態（starting/started/stopping/stopped/suspending/suspended/resuming/reconfiguring）を管理します。Managerはノード上でエージェントを起動し、状態変化を監視し、障害発生時に他のエージェントを再構成します。

**耐障害性（Fault Tolerance）**は、Erlangの監視ツリー（supervision tree）を活用して実現されます。各ノードにスーパーバイザプロセスを配置し、エージェントの状態を監視します。エージェントが失敗すると、スーパーバイザが失敗前の状態（意図、ゴール、信念）を復元して再起動します。ただし、協調により学習したプランは揮発性として扱い、再起動後に再学習されます。

Webアプリケーションエンジニアにとって、この研究は分散AIシステムの設計パターンとして以下の示唆を与えます。第一に、関数型プログラミング（高階関数、クロージャ）が複雑な動的振る舞いのモデリングに有効であること。第二に、プロセスベースの並行処理が、エージェント間の独立性と協調を自然に表現できること。第三に、動的再構成と耐障害性の組み合わせが、変化の激しい環境でのシステム安定性を実現できること。現代のマイクロサービスアーキテクチャやサーバーレス環境において、Erlang/Elixirが採用される理由は、まさにこの20年前の研究が示した設計原則の有効性にあります。AI Agentアーキテクチャの再発明においても、BDIモデルと関数型プログラミングの組み合わせは、依然として強力なアプローチと言えるでしょう。
