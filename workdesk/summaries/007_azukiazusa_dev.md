## Claude Code の LSP サポート

https://azukiazusa.dev/blog/claude-code-lsp-support/

Claude Code v2.0.74 において LSP（Language Server Protocol）サポートが導入され、コードの構造を理解した高度な定義検索や参照検索が可能になったことを報告している。

**Content Type**: ⚙️ Tools
**Language**: ja

**Scores**: Signal:4/5 | Depth:4/5 | Unique:3/5 | Practical:4/5 | Anti-Hype:4/5
**Main Journal**: 76/100 | **Annex Potential**: 73/100 | **Overall**: 76/100

**Topics**: [[Claude Code, LSP, AIエージェント, 開発ツール, TypeScript]]

Claude Code のバージョン 2.0.74 において、LSP（Language Server Protocol）サポートがプラグイン形式で追加された。これにより、AIエージェントは単なる文字列検索ではなく、コードの構造やシンボルの定義、参照関係を正確に把握した上で操作が可能になる。これは開発効率の向上とトークン消費の最適化において極めて重要な進歩である。

本機能の有効化は、Claude Code 内の `/plugin` コマンドから公式マーケットプレイスを通じて言語別の LSP プラグイン（C, Go, Python, Rust 等）を導入することで行われる。さらに、ローカル環境に対象言語の LSP サーバー（例：`typescript-language-server`）をインストールする必要がある。これにより、定義へのジャンプ（goToDefinition）、全参照の検索（findReferences）、型情報やドキュメントの取得（hover）、呼び出し階層の確認（prepareCallHierarchy）といった、IDE と同等のセマンティックなコード解析ツールを Claude Code が内部的に活用できるようになる。

著者は、この進歩の意義を「エージェントがコードの構造をセマンティックに理解できる点」にあると強調している。従来の文字列ベースの検索では、大規模なコードベースにおいて誤検知や情報の欠落が発生しやすく、コンテキスト把握に多くのトークンと時間を要していた。LSP を利用することで、正確な情報を迅速に取得・編集できるようになり、AI との協業における精度と速度が大幅に向上すると筆者は主張する。

ただし、著者は現時点での実用上の課題についても率直に言及している。最新の v2.0.74 ではプラグインと LSP サーバーの初期化プロセスにおける競合（レースコンディション）が発生し、特に TypeScript 等で正しく動作しない不具合が GitHub Issue 等で報告されている。この問題に対し、著者は特定の旧バージョン（v2.0.67）を使用し、環境変数 `ENABLE_LSP_TOOL=true` を設定して起動するという、エンジニアにとって即座に役立つ具体的な回避策を提示している。

また、公式で未対応の言語についても、`.lsp.json` 設定ファイルを含む自作プラグインを作成することで LSP サーバーを統合する手順が解説されている。著者は、コーディングエージェントが LSP という標準プロトコルを扱えるようになることは、将来的にあらゆる開発環境において AI がより自律的かつ正確にタスクを遂行するための強力な武器になると結論付けている。